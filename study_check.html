<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ììŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸</title>

<style>
body {
  font-family: 'Segoe UI', sans-serif;
  background: #f5f7fb;
  padding: 20px;
}

h2 { margin-bottom: 10px; }

a {
  text-decoration: none;
  color: #4a5bdc;
  font-weight: 600;
  display: inline-block;
  margin-bottom: 20px;
}

.class-buttons { margin: 20px 0; }

.class-buttons button {
  margin: 4px;
  padding: 8px 16px;
  border: none;
  border-radius: 20px;
  background: #e0e4ff;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s ease;
}

.class-buttons button:hover {
  background: #c5ccff;
}

.class-buttons button.active {
  background: #4a5bdc;
  color: white;
}

/* í†µê³„ ì˜ì—­ */
#stats {
  background: white;
  padding: 15px;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.08);
  margin-bottom: 20px;
  font-size: 14px;
  line-height: 1.8;
}

table {
  width: 100%;
  border-collapse: collapse;
  background: white;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 4px 10px rgba(0,0,0,0.08);
}

thead {
  background: #4a5bdc;
  color: white;
}

th, td {
  padding: 10px;
  text-align: center;
  border: 1px solid #e0e4ff;
  font-size: 13px;
}

tbody tr:nth-child(even) { background: #f8f9fa; }
tbody tr:hover { background: #e8ecff; }

input[type="checkbox"] {
  width: 18px;
  height: 18px;
  cursor: pointer;
  accent-color: #4a5bdc;
}

td:first-child {
  font-weight: 600;
  color: #4a5bdc;
  background: #f0f2ff;
}
</style>
</head>

<body>

<h2>ğŸ“˜ ììŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>
<a href="index.html">â† í™ˆìœ¼ë¡œ</a>

<!-- ë°˜ ì„ íƒ ë²„íŠ¼ -->
<div class="class-buttons" id="classButtons"></div>

<!-- í†µê³„ ì˜ì—­ -->
<div id="stats"></div>

<!-- ì²´í¬ë¦¬ìŠ¤íŠ¸ í…Œì´ë¸” -->
<table>
<thead>
<tr>
  <th rowspan="2">ë²ˆí˜¸</th>
  <th colspan="15">ììŠµ ì²´í¬</th>
</tr>
<tr>
  <th>ì›” 8êµì‹œ</th><th>ì›” ì•¼ì1</th><th>ì›” ì•¼ì2</th>
  <th>í™” 8êµì‹œ</th><th>í™” ì•¼ì1</th><th>í™” ì•¼ì2</th>
  <th>ìˆ˜ 8êµì‹œ</th><th>ìˆ˜ ì•¼ì1</th><th>ìˆ˜ ì•¼ì2</th>
  <th>ëª© 8êµì‹œ</th><th>ëª© ì•¼ì1</th><th>ëª© ì•¼ì2</th>
  <th>ê¸ˆ 8êµì‹œ</th><th>ê¸ˆ ì•¼ì1</th><th>ê¸ˆ ì•¼ì2</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>

<script>
/* === ì „ì—­ ë³€ìˆ˜ === */
let currentClass = "1ë°˜"; // í˜„ì¬ ì„ íƒëœ ë°˜
const tableBody = document.getElementById("tableBody");
const classButtons = document.getElementById("classButtons");

/* === 1~7ë°˜ ë²„íŠ¼ ìƒì„± === */
for(let i=1; i<=7; i++){
  const btn = document.createElement("button");
  btn.innerText = i + "ë°˜";
  if(i===1) btn.classList.add("active"); // 1ë°˜ ê¸°ë³¸ ì„ íƒ
  btn.onclick = () => switchClass(i+"ë°˜", btn);
  classButtons.appendChild(btn);
}

/* === ë°˜ ì „í™˜ í•¨ìˆ˜ === */
function switchClass(cls, btn){
  currentClass = cls;
  document.querySelectorAll(".class-buttons button")
    .forEach(b => b.classList.remove("active"));
  btn.classList.add("active");
  render();
  renderStats();
}

/* === ë°ì´í„° ê°€ì ¸ì˜¤ê¸° === */
function getData(){
  let data = JSON.parse(localStorage.getItem("study_"+currentClass));
  if(!data){
    data = [];
    for(let i=1; i<=24; i++){
      data.push({ 
        number: i, 
        checks: Array(15).fill(false) // 15ê°œ ì²´í¬ë°•ìŠ¤ ì´ˆê¸°í™”
      });
    }
    localStorage.setItem("study_"+currentClass, JSON.stringify(data));
  }
  return data;
}

/* === ì²´í¬ë°•ìŠ¤ í† ê¸€ === */
function toggleCheck(s, c){
  const data = getData();
  data[s].checks[c] = !data[s].checks[c]; // ì²´í¬ ìƒíƒœ ë°˜ì „
  localStorage.setItem("study_"+currentClass, JSON.stringify(data));
  renderStats(); // í†µê³„ ì—…ë°ì´íŠ¸
}

/* === í…Œì´ë¸” ë Œë”ë§ === */
function render(){
  const data = getData();
  tableBody.innerHTML = "";
  
  data.forEach((stu, s) => {
    const tr = document.createElement("tr");
    
    // ë²ˆí˜¸ ì…€ ì¶”ê°€
    const numberCell = document.createElement("td");
    numberCell.textContent = stu.number;
    tr.appendChild(numberCell);
    
    // 15ê°œ ì²´í¬ë°•ìŠ¤ ì…€ ì¶”ê°€ (forEach ëŒ€ì‹  for ë£¨í”„ ì‚¬ìš©)
    for(let c = 0; c < 15; c++){
      const td = document.createElement("td");
      const cb = document.createElement("input");
      cb.type = "checkbox";
      cb.checked = stu.checks[c]; // ì €ì¥ëœ ìƒíƒœ ì ìš©
      
      // í´ë¡œì €ë¡œ ì¸ë±ìŠ¤ ìº¡ì²˜
      cb.onchange = (function(studentIndex, checkIndex){
        return function(){
          toggleCheck(studentIndex, checkIndex);
        };
      })(s, c);
      
      td.appendChild(cb);
      tr.appendChild(td);
    }
    
    tableBody.appendChild(tr);
  });
}

/* === í†µê³„ ë Œë”ë§ === */
function renderStats(){
  const data = getData();
  const statsDiv = document.getElementById("stats");

  const totalStudents = 24;
  const totalSlots = 15;
  let checkedTotal = 0;

  // ìš”ì¼Â·êµì‹œë³„ ì¹´ìš´íŠ¸
  const slotCount = Array(15).fill(0);

  data.forEach(stu => {
    stu.checks.forEach((chk, i) => {
      if(chk){
        checkedTotal++;
        slotCount[i]++;
      }
    });
  });

  const maxChecks = totalStudents * totalSlots;
  const percent = Math.round((checkedTotal / maxChecks) * 100);

  const labels = [
    "ì›” 8êµì‹œ","ì›” ì•¼ì1","ì›” ì•¼ì2",
    "í™” 8êµì‹œ","í™” ì•¼ì1","í™” ì•¼ì2",
    "ìˆ˜ 8êµì‹œ","ìˆ˜ ì•¼ì1","ìˆ˜ ì•¼ì2",
    "ëª© 8êµì‹œ","ëª© ì•¼ì1","ëª© ì•¼ì2",
    "ê¸ˆ 8êµì‹œ","ê¸ˆ ì•¼ì1","ê¸ˆ ì•¼ì2"
  ];

  let html = `
    <strong>ğŸ“Š ${currentClass} ììŠµ í†µê³„</strong><br>
    ì „ì²´ ë‹¬ì„±ë¥ : <strong style="color:#4a5bdc;">${percent}%</strong>
    (${checkedTotal}/${maxChecks})<br><br>
  `;

  labels.forEach((label, i) => {
    const rate = Math.round((slotCount[i] / totalStudents) * 100);
    html += `${label}: <strong>${slotCount[i]}</strong>/24ëª… (${rate}%)<br>`;
  });

  statsDiv.innerHTML = html;
}

/* === ì´ˆê¸° ë Œë”ë§ === */
render();
renderStats();
</script>

</body>
</html>
