<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ë°˜ë³„ íˆ¬ë‘ë¦¬ìŠ¤íŠ¸</title>
<style>
body {
  font-family:'Segoe UI', sans-serif;
  background:#f5f7fb;
  padding:20px;
}

h2 { margin-bottom:8px; }

a {
  text-decoration:none;
  color:#4a5bdc;
  font-weight:600;
}

.date-bar {
  display:flex;
  align-items:center;
  gap:15px;
  margin:15px 0;
}

.date-bar button {
  padding:4px 10px;
  font-size:16px;
}

.class-buttons button {
  margin:4px;
  padding:6px 14px;
  border:none;
  border-radius:20px;
  background:#e0e4ff;
  cursor:pointer;
  font-weight:600;
}

.class-buttons button.active {
  background:#4a5bdc;
  color:white;
}

.student {
  background:white;
  border-radius:10px;
  padding:12px;
  margin-bottom:12px;
  box-shadow:0 4px 10px rgba(0,0,0,0.06);
}

.task {
  display:flex;
  align-items:center;
  gap:6px;
  margin:4px 0;
}

.task.done span {
  text-decoration:line-through;
  opacity:0.6;
}

.task button {
  background:#ff6b6b;
  border:none;
  color:white;
  padding:2px 6px;
  border-radius:4px;
  cursor:pointer;
}

.add-task {
  margin-top:6px;
}

.add-task input {
  width:70%;
}
</style>
</head>
<body>

<h2>ğŸ“ ë°˜ë³„ íˆ¬ë‘ë¦¬ìŠ¤íŠ¸</h2>
<a href="index.html">â† í™ˆìœ¼ë¡œ</a>

<!-- ë‚ ì§œ -->
<div class="date-bar">
  <button onclick="changeDate(-1)">â—€</button>
  <strong id="dateText"></strong>
  <button onclick="changeDate(1)">â–¶</button>
</div>

<!-- ë°˜ ì„ íƒ -->
<div class="class-buttons" id="classButtons"></div>

<!-- í•™ìƒ -->
<div id="studentArea"></div>

<script>
let currentClass="1ë°˜";
let currentDate=new Date();

const studentArea=document.getElementById("studentArea");
const dateText=document.getElementById("dateText");

/* ë‚ ì§œ */
function formatDate(d){
  return d.toISOString().slice(0,10);
}
function showDate(){
  dateText.innerText =
    `${currentDate.getMonth()+1} / ${currentDate.getDate()}`;
}
function changeDate(diff){
  currentDate.setDate(currentDate.getDate()+diff);
  showDate();
  render();
}

/* ë°˜ ë²„íŠ¼ */
for(let i=1;i<=7;i++){
  const btn=document.createElement("button");
  btn.innerText=i+"ë°˜";
  if(i===1) btn.classList.add("active");
  btn.onclick=()=>{
    document.querySelectorAll(".class-buttons button")
      .forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    currentClass=i+"ë°˜";
    render();
  };
  classButtons.appendChild(btn);
}

/* ë°ì´í„° */
function key(){
  return `todo_${currentClass}_${formatDate(currentDate)}`;
}

function getData(){
  let data=JSON.parse(localStorage.getItem(key()));
  if(!data){
    data=[];
    for(let i=1;i<=24;i++){
      data.push({number:i,tasks:[]});
    }
    saveData(data);
  }
  return data;
}

function saveData(d){
  localStorage.setItem(key(),JSON.stringify(d));
}

/* ê¸°ëŠ¥ */
function addTask(sIndex,input){
  if(!input.value) return;
  const d=getData();
  d[sIndex].tasks.push({text:input.value,done:false});
  saveData(d);
  render();
}

function toggle(s,t){
  const d=getData();
  d[s].tasks[t].done=!d[s].tasks[t].done;
  saveData(d);
  render();
}

function removeTask(s,t){
  const d=getData();
  d[s].tasks.splice(t,1);
  saveData(d);
  render();
}

/* ë Œë” */
function render(){
  const d=getData();
  studentArea.innerHTML="";

  d.forEach((stu,s)=>{
    const box=document.createElement("div");
    box.className="student";
    box.innerHTML=`<h3>${stu.number}ë²ˆ</h3>`;

    stu.tasks.forEach((task,t)=>{
      box.innerHTML+=`
        <div class="task ${task.done?"done":""}">
          <input type="checkbox"
            ${task.done?"checked":""}
            onclick="toggle(${s},${t})">
          <span>${task.text}</span>
          <button onclick="removeTask(${s},${t})">X</button>
        </div>`;
    });

    box.innerHTML+=`
      <div class="add-task">
        <input placeholder="í•  ì¼ ì¶”ê°€"
          onkeydown="if(event.key==='Enter') addTask(${s},this)">
        <button onclick="addTask(${s},this.previousElementSibling)">ì¶”ê°€</button>
      </div>`;
    studentArea.appendChild(box);
  });
}

showDate();
render();
</script>

</body>
</html>
