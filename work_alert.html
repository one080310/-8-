<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ê³¼ì œ ê³µì§€</title>
<link rel="stylesheet" href="./common.css">
</head>
<body>

<h2>ğŸ“¢ ê³¼ì œ ê³µì§€</h2>
<a href="index.html">â† í™ˆ</a>

<!-- ì„ ìƒë‹˜ ì „ìš© -->
<div id="teacherBox"></div>

<div id="workArea"></div>

<script>
const ROLE=localStorage.getItem("role");
const USER=localStorage.getItem("user");
if(!ROLE) location.href="index.html";

let works=JSON.parse(localStorage.getItem("works"))||[];

function addWork(){
  const t=title.value;
  const c=content.value;
  const d=deadline.value;
  works.push({id:Date.now(),title:t,content:c,deadline:d});
  localStorage.setItem("works",JSON.stringify(works));
  render();
}

function submit(id){
  const key="submit_"+id;
  let list=JSON.parse(localStorage.getItem(key))||[];
  if(!list.includes(USER)){
    list.push(USER);
    localStorage.setItem(key,JSON.stringify(list));
    render();
  }
}

function render(){
  workArea.innerHTML="";
  teacherBox.innerHTML="";

  if(ROLE==="teacher"){
    teacherBox.innerHTML=`
      <h3>ê³¼ì œ ì¶”ê°€</h3>
      <input id="title" placeholder="ì œëª©">
      <input id="content" placeholder="ë‚´ìš©">
      <input id="deadline" type="date">
      <button onclick="addWork()">ì¶”ê°€</button><hr>
    `;
  }

  works.forEach(w=>{
    const key="submit_"+w.id;
    let list=JSON.parse(localStorage.getItem(key))||[];
    const submitted=list.includes(USER);
    const closed=new Date().toISOString().slice(0,10)>w.deadline;

    workArea.innerHTML+=`
      <div class="notice">
        <h3>${w.title}</h3>
        <p>${w.content}</p>
        <p>ë§ˆê°: ${w.deadline}</p>
        <p>ì œì¶œ: ${list.length}/24</p>

        ${ROLE==="student" ? `
          <button onclick="submit(${w.id})"
            ${submitted||closed?"disabled":""}>
            ${submitted?"ì œì¶œ ì™„ë£Œ":closed?"ë§ˆê°":"ì œì¶œ"}
          </button>` : `
          <details>
            <summary>ì œì¶œì ëª…ë‹¨</summary>
            ${list.map(n=>n+
